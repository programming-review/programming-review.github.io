---
id: 12971
title: Chi Squared distribution
date: 2020-05-03
author: taimane
layout: post
permalink: /statistics/chisquared
published: true
image: 
categories: 
   - statistics
tags:
   - chisquared
---
<script type="text/x-mathjax-config">
    MathJax.Hub.Config({
      tex2jax: {
        skipTags: ['script', 'noscript', 'style', 'textarea', 'pre'],
        inlineMath: [['$','$']]
      }
    });
</script>
<script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML" type="text/javascript"></script>

Discovered by Robert Helmert in 1875 **chi-squared distribution** is one of the most frequent distributions in statistics. It can be thought of as the "square" of a Z (standard normal distribution).

To create chi-squared distribution we start from Z-distribution.

$$Z \sim \mathcal N(0,1)$$

And write:

$$Z_1^2 \sim \chi_1^2$$

How to get two degrees of freedom?

$$ Z_1^2 + Z_2^2 \sim \chi_2^2$$

Simple we square two $Z$ distributions and sum them up to get what is called Chi-Squared distribution with two degrees of freedom.


R code simulation for $\chi_2^2$

```r
set.seed(0)
x1 = rnorm(10^6);  x2 = rnorm(10^6)
y1 = x1^2 + x2^2
hdr = "Simulated Values of CHISQ(df = 2)"
hist(y1, prob=T, br=30, col="skyblue2", main=hdr)
curve(dchisq(x, 2), add=T, lwd=2, col="orange")
```

![Chi Square with two degrees of freedom](/wp-content/uploads/2021/03/chisq1.png)


In general to get $k$ degrees of freedom:

$$\sum_{i=1}^{n} Z_{i}^{2} \sim \chi_{n}^{2}$$

**Example**: different degrees of freedom
![chisq](/wp-content/uploads/2021/03/chisq.gif)
## PDF and moments

Chi-Squared is actually gamma distribution with shape parameter $n/2$ and scale parameter $2$ is called the chi-square distribution with $n$ degrees of freedom. PDF is:

$$f(x)=\frac{1}{2^{n / 2} \Gamma(n / 2)} x^{n / 2-1} e^{-x / 2}, \quad x \in(0, \infty)$$

---

**Example:** Let's show what happens if we square 10^5 numbers from $\mathcal N(1,2)$ distribution and check for the mean of these numbers.

<!-- X11 ()
c<-0
for (i in 1:10){
#for(i in c(0, 0.1, 0.25, 0.5, 0.75, 1, 2, 3, 4, 5, 6, 7 )){
  x <- 0:20
  c<-c+1
  dev.new(width = 750, height = 450, unit = "px", noRStudioGD = TRUE)
  png(paste('C:\\Users\\dj\\R\\', c,'.png'), width = 800, height = 600)
  
  plot(x,dchisq(x,df=i),
       type='h',
       main=paste('Chi Squared Distribution df=',i),
       ylab='Probability',
       xlab ='x',
       col='blue2',
       #ylim=c(0, 1),
       lwd=10)
 
  dev.off()
} -->

```R
set.seed(0)
x1 = rnorm(10^5, mean=1, sd=2)
y1 = x1^2
mean(y1)
```

Out:
```
5.013841
```
> This mean is $\mu + \sigma^2$ in other words. For the case where we have $Z$ distributions it is only $\sigma^2$.
> 
---

For Variance $\mathbb V$ we have:

$$\mathbb V(Z) =\mathbb E[Z^2] - ( \mathbb E[Z])^2$$ 

Since $\mathbb E[Z]=0$ we have:

$$\mathbb V(Z) =\mathbb E[Z^2]$$

Finally, $\mathbb E[\chi_n]=n$, $\mathbb V(\chi_n) = 2n$



